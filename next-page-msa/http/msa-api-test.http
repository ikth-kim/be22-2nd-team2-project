### ===================================================================
### Next Page MSA API Test Suite
### ===================================================================
### ì´ íŒŒì¼ì€ Next Page MSA í™˜ê²½ì˜ ëª¨ë“  APIë¥¼ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.
### Gateway Server(Port 8000)ë¥¼ í†µí•´ ê° ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¡œ ë¼ìš°íŒ…ë©ë‹ˆë‹¤.
### ===================================================================
###
### ğŸ“Œ ì‚¬ìš© ë°©ë²• (ìë™ í† í°):
### 1. ë¨¼ì € 1-1(íšŒì›ê°€ì…) ì‹¤í–‰í•˜ì—¬ ê³„ì • ìƒì„±
### 2. 1-4(ë¡œê·¸ì¸) ì‹¤í–‰ â†’ í† í°ì´ ìë™ìœ¼ë¡œ ì €ì¥ë¨
### 3. ì´í›„ ì¸ì¦ì´ í•„ìš”í•œ API ë°”ë¡œ ì‹¤í–‰ ê°€ëŠ¥!
### 4. 1-8~1-11ë¡œ ì‹¤ì‹œê°„ ì¤‘ë³µ ê²€ì¦ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
###
### âš ï¸ ìë™ ì €ì¥ì´ ì•ˆ ë˜ë©´? ì•„ë˜ ì£¼ì„ í•´ì œ í›„ í† í° ì§ì ‘ ì…ë ¥:
### @accessToken = ì—¬ê¸°ì—_í† í°_ë¶™ì—¬ë„£ê¸°
### ===================================================================

### í™˜ê²½ ë³€ìˆ˜ (MSA Gateway Port)
@baseUrl = http://localhost:8000


### ===================================================================
### 1. íšŒì› ì¸ì¦ (Auth) API - Member Service
### ===================================================================

### ----------------------------------------
### 1-1. íšŒì›ê°€ì… (ì¼ë°˜ ì‚¬ìš©ì)
### ----------------------------------------
POST {{baseUrl}}/api/auth/signup
Content-Type: application/json

{
  "userEmail": "msauser@example.com",
  "userPw": "password123!",
  "userNicknm": "MSAìœ ì €"
}

### ----------------------------------------
### 1-2. íšŒì›ê°€ì… (ë‹‰ë„¤ì„ ë‹¤ë¥¸ ì‚¬ìš©ì)
### ----------------------------------------
POST {{baseUrl}}/api/auth/signup
Content-Type: application/json

{
  "userEmail": "msauser2@example.com",
  "userPw": "password123!",
  "userNicknm": "MSAìœ ì €2"
}

### ----------------------------------------
### 1-3. ê´€ë¦¬ì ê³„ì • ìƒì„±
### ----------------------------------------
POST {{baseUrl}}/api/auth/admin
Content-Type: application/json

{
  "userEmail": "msaadmin@example.com",
  "userPw": "adminpassword123!",
  "userNicknm": "MSAê´€ë¦¬ì"
}

### ----------------------------------------
### 1-4. ë¡œê·¸ì¸ (ì¼ë°˜ ì‚¬ìš©ì) - í† í° ë°œê¸‰
### ----------------------------------------
# @name login
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "userEmail": "msauser@example.com",
  "userPw": "password123!"
}

> {%
  client.global.set("accessToken", response.body.data.accessToken);
  client.global.set("refreshToken", response.body.data.refreshToken);
%}



### ----------------------------------------
### 1-5. ë¡œê·¸ì¸ (ê´€ë¦¬ì)
### ----------------------------------------
# @name adminLogin
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "userEmail": "msaadmin@example.com",
  "userPw": "adminpassword123!"
}

> {%
  client.global.set("adminAccessToken", response.body.data.accessToken);
%}

### ----------------------------------------
### 1-6. í† í° ê°±ì‹ 
### ----------------------------------------
POST {{baseUrl}}/api/auth/refresh
Content-Type: application/json
Cookie: refreshToken={{refreshToken}}

### ----------------------------------------
### 1-7. ë¡œê·¸ì•„ì›ƒ
### ----------------------------------------
POST {{baseUrl}}/api/auth/logout
Content-Type: application/json
Cookie: refreshToken={{refreshToken}}

### ----------------------------------------
### 1-8. ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸
### ----------------------------------------
GET {{baseUrl}}/api/auth/check-email?email=msauser@example.com

### ----------------------------------------
### 1-9. ì´ë©”ì¼ ì¤‘ë³µ í™•ì¸ (ì‚¬ìš© ê°€ëŠ¥í•œ ì´ë©”ì¼)
### ----------------------------------------
GET {{baseUrl}}/api/auth/check-email?email=available@example.com

### ----------------------------------------
### 1-10. ë‹‰ë„¤ì„ ì¤‘ë³µ í™•ì¸
### ----------------------------------------
GET {{baseUrl}}/api/auth/check-nickname?nickname=MSAìœ ì €

### ----------------------------------------
### 1-11. ë‹‰ë„¤ì„ ì¤‘ë³µ í™•ì¸ (ì‚¬ìš© ê°€ëŠ¥í•œ ë‹‰ë„¤ì„)
### ----------------------------------------
GET {{baseUrl}}/api/auth/check-nickname?nickname=ì‚¬ìš©ê°€ëŠ¥ë‹‰ë„¤ì„

### ----------------------------------------
### 1-12. íšŒì› íƒˆí‡´
### ----------------------------------------
DELETE {{baseUrl}}/api/auth/withdraw
Authorization: Bearer {{accessToken}}

### ===================================================================
### 2. íšŒì› (Member) Query API - Member Service
### ===================================================================

### ----------------------------------------
### 2-1. ë§ˆì´í˜ì´ì§€ ì¡°íšŒ (ë‚´ ì •ë³´)
### ----------------------------------------
# @no-cookie-jar
GET {{baseUrl}}/api/members/me
Authorization: Bearer {{accessToken}}

### ===================================================================
### 3. ì†Œì„¤ (Book) Command API - Story Service
### ===================================================================

### ----------------------------------------
### 3-1. ì†Œì„¤ ìƒì„±
### ----------------------------------------
# @name createBook
POST {{baseUrl}}/api/books
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "title": "MSA í™˜ê²½ì˜ ìƒˆë¡œìš´ ì†Œì„¤",
  "categoryId": "1",
  "maxSequence": 100,
  "firstSentence": "ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì„¸ê³„ì—ì„œ ì²« ë²ˆì§¸ ì´ì•¼ê¸°ê°€ ì‹œì‘ë˜ì—ˆë‹¤."
}

> {%
  client.global.set("createdBookId", response.body.data);
%}

### ----------------------------------------
### 3-2. ì†Œì„¤ ìƒì„± (ì œëª© ì—†ìŒ - ì—ëŸ¬ ì¼€ì´ìŠ¤)
### ----------------------------------------
POST {{baseUrl}}/api/books
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "title": "",
  "categoryId": "1",
  "maxSequence": 50,
  "firstSentence": "í…ŒìŠ¤íŠ¸ ì²« ë¬¸ì¥ì…ë‹ˆë‹¤."
}

### ----------------------------------------
### 3-3. ì†Œì„¤ ìƒì„± (ë¡œë§¨ìŠ¤ ì¹´í…Œê³ ë¦¬)
### ----------------------------------------
POST {{baseUrl}}/api/books
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "title": "ë¶„ì‚°ëœ ë§ˆìŒ",
  "categoryId": "2",
  "maxSequence": 50,
  "firstSentence": "ì„œë¹„ìŠ¤ê°€ ë¶„ë¦¬ë˜ì–´ë„ ìš°ë¦¬ì˜ ë§ˆìŒì€ ì—°ê²°ë˜ì–´ ìˆì—ˆë‹¤."
}

### ----------------------------------------
### 3-4. ì†Œì„¤ ìƒì„± (ìŠ¤ë¦´ëŸ¬ ì¹´í…Œê³ ë¦¬)
### ----------------------------------------
POST {{baseUrl}}/api/books
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "title": "ëŠì–´ì§„ ì—°ê²°",
  "categoryId": "3",
  "maxSequence": 80,
  "firstSentence": "Circuit Breakerê°€ ì—´ë¦¬ëŠ” ìˆœê°„, ëª¨ë“  í†µì‹ ì´ ë‘ì ˆë˜ì—ˆë‹¤."
}

### ----------------------------------------
### 3-5. ë¬¸ì¥ ì´ì–´ì“°ê¸°
### ----------------------------------------
# @name appendSentence
POST {{baseUrl}}/api/books/{{createdBookId}}/sentences
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": "ê° ì„œë¹„ìŠ¤ë“¤ì´ ì„œë¡œ í˜‘ë ¥í•˜ì—¬ ì´ì•¼ê¸°ë¥¼ ë§Œë“¤ì–´ê°€ê¸° ì‹œì‘í–ˆë‹¤."
}

> {%
  client.global.set("sentenceId", response.body.data);
%}

### ----------------------------------------
### 3-6. ë¬¸ì¥ ì´ì–´ì“°ê¸° (ë‘ ë²ˆì§¸ ë¬¸ì¥)
### ----------------------------------------
POST {{baseUrl}}/api/books/{{createdBookId}}/sentences
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": "ê²Œì´íŠ¸ì›¨ì´ëŠ” ê·¸ë“¤ì˜ ìš”ì²­ì„ ë¬µë¬µíˆ ì¤‘ê³„í•˜ê³  ìˆì—ˆë‹¤."
}

### ----------------------------------------
### 3-7. ë¬¸ì¥ ì´ì–´ì“°ê¸° (ë„ˆë¬´ ì§§ì€ ë¬¸ì¥ - ì—ëŸ¬ ì¼€ì´ìŠ¤)
### ----------------------------------------
POST {{baseUrl}}/api/books/{{createdBookId}}/sentences
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": "ì§§ì€ë¬¸ì¥"
}

### ----------------------------------------
### 3-8. ë¬¸ì¥ ì´ì–´ì“°ê¸° (ë¹ˆ ë¬¸ì¥ - ì—ëŸ¬ ì¼€ì´ìŠ¤)
### ----------------------------------------
POST {{baseUrl}}/api/books/{{createdBookId}}/sentences
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": ""
}

### ----------------------------------------
### 3-9. ë¬¸ì¥ ì´ì–´ì“°ê¸° (ì¸ì¦ ì—†ì´ - ì—ëŸ¬ ì¼€ì´ìŠ¤)
### ----------------------------------------
POST {{baseUrl}}/api/books/{{createdBookId}}/sentences
Content-Type: application/json

{
  "content": "ì¸ì¦ ì—†ì´ ì‘ì„± í…ŒìŠ¤íŠ¸"
}

### ===================================================================
### 4. ì†Œì„¤ (Book) Query API - Story Service
### ===================================================================

### ----------------------------------------
### 4-1. ì†Œì„¤ ëª©ë¡ ì¡°íšŒ (ê¸°ë³¸)
### ----------------------------------------
GET {{baseUrl}}/api/books

### ----------------------------------------
### 4-2. ì†Œì„¤ ëª©ë¡ ì¡°íšŒ (í˜ì´ì§•)
### ----------------------------------------
GET {{baseUrl}}/api/books?page=0&size=10

### ----------------------------------------
### 4-3. ì†Œì„¤ ëª©ë¡ ì¡°íšŒ (ì •ë ¬: ìµœì‹ ìˆœ)
### ----------------------------------------
GET {{baseUrl}}/api/books?page=0&size=10&sortBy=createdAt&sortOrder=desc

### ----------------------------------------
### 4-4. ì†Œì„¤ ëª©ë¡ ì¡°íšŒ (ì •ë ¬: ì œëª©ìˆœ)
### ----------------------------------------
GET {{baseUrl}}/api/books?page=0&size=10&sortBy=title&sortOrder=asc

### ----------------------------------------
### 4-5. ì†Œì„¤ ëª©ë¡ ì¡°íšŒ (ìƒíƒœ í•„í„°: ì§„í–‰ì¤‘)
### ----------------------------------------
GET {{baseUrl}}/api/books?status=IN_PROGRESS

### ----------------------------------------
### 4-6. ì†Œì„¤ ëª©ë¡ ì¡°íšŒ (ì¹´í…Œê³ ë¦¬ í•„í„°)
### ----------------------------------------
GET {{baseUrl}}/api/books?categoryId=1

### ----------------------------------------
### 4-7. ì†Œì„¤ ëª©ë¡ ì¡°íšŒ (í‚¤ì›Œë“œ ê²€ìƒ‰)
### ----------------------------------------
GET {{baseUrl}}/api/books?keyword=MSA

### ----------------------------------------
### 4-8. ì†Œì„¤ ëª©ë¡ ì¡°íšŒ (ë³µí•© í•„í„°)
### ----------------------------------------
GET {{baseUrl}}/api/books?page=0&size=10&sortBy=createdAt&sortOrder=desc&categoryId=1&keyword=MSA

### ----------------------------------------
### 4-9. ì†Œì„¤ ìƒì„¸ ì¡°íšŒ
### ----------------------------------------
GET {{baseUrl}}/api/books/{{createdBookId}}

### ----------------------------------------
### 4-10. ì†Œì„¤ ìƒì„¸ ì¡°íšŒ (ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ID)
### ----------------------------------------
GET {{baseUrl}}/api/books/99999

### ----------------------------------------
### 4-11. ì†Œì„¤ ë·°ì–´ ëª¨ë“œ ì¡°íšŒ (ë¬¸ì¥ ëª©ë¡ í¬í•¨)
### ----------------------------------------
GET {{baseUrl}}/api/books/{{createdBookId}}/view

### ----------------------------------------
### 4-12. ë‚´ê°€ ì“´ ë¬¸ì¥ ëª©ë¡ (MSA Feign í…ŒìŠ¤íŠ¸)
### ----------------------------------------
GET {{baseUrl}}/api/books/mysentences
Authorization: Bearer {{accessToken}}


### ===================================================================
### 5. ë°˜ì‘ - ëŒ“ê¸€ (Comment) Command API - Reaction Service
### ===================================================================

### ----------------------------------------
### 5-1. ëŒ“ê¸€ ì‘ì„±
### ----------------------------------------
# @name createComment
POST {{baseUrl}}/api/reactions/comments
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "bookId": {{createdBookId}},
  "content": "MSA í™˜ê²½ì—ì„œë„ ëŒ“ê¸€ì´ ì˜ ì‘ì„±ë˜ë„¤ìš”!"
}

> {%
  client.global.set("commentId", response.body.data);
%}

### ----------------------------------------
### 5-2. ëŒ“ê¸€ ì‘ì„± (createdBookId ì‚¬ìš©)
### ----------------------------------------
POST {{baseUrl}}/api/reactions/comments
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "bookId": {{createdBookId}},
  "content": "Latency ì—†ì´ ì•„ì£¼ ì¾Œì í•©ë‹ˆë‹¤."
}

### ----------------------------------------
### 5-3. ëŒ“ê¸€ ìˆ˜ì •
### ----------------------------------------
PATCH {{baseUrl}}/api/reactions/comments/{{commentId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": "ëŒ“ê¸€ ìˆ˜ì • ê¸°ëŠ¥ë„ ì •ìƒ ë™ì‘í•©ë‹ˆë‹¤."
}

### ----------------------------------------
### 5-4. ëŒ“ê¸€ ì‚­ì œ
### ----------------------------------------
DELETE {{baseUrl}}/api/reactions/comments/{{commentId}}
Authorization: Bearer {{accessToken}}

### ----------------------------------------
### 5-5. ëŒ€ëŒ“ê¸€(ë‹µê¸€) ì‘ì„±
### ----------------------------------------
# @name createReply
POST {{baseUrl}}/api/reactions/comments
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "bookId": {{createdBookId}},
  "content": "ëŒ€ëŒ“ê¸€ë„ ì˜ ë‹¬ë¦¬ë„¤ìš”.",
  "parentId": {{commentId}}
}

### ===================================================================
### 6. ë°˜ì‘ - ëŒ“ê¸€ (Comment) Query API - Reaction Service
### ===================================================================

### ----------------------------------------
### 6-1. ëŒ“ê¸€ ëª©ë¡ ì¡°íšŒ
### ----------------------------------------
GET {{baseUrl}}/api/reactions/comments/{{createdBookId}}

### ----------------------------------------
### 6-2. ë‚´ ëŒ“ê¸€ ëª©ë¡ ì¡°íšŒ (MSA Feign í…ŒìŠ¤íŠ¸)
### ----------------------------------------
GET {{baseUrl}}/api/reactions/mycomments
Authorization: Bearer {{accessToken}}

### ===================================================================
### 7. ë°˜ì‘ - íˆ¬í‘œ (Vote) API - Reaction Service
### ===================================================================

### ----------------------------------------
### 7-1. ì†Œì„¤ ì¢‹ì•„ìš” íˆ¬í‘œ
### ----------------------------------------
POST {{baseUrl}}/api/reactions/votes/books
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "bookId": {{createdBookId}},
  "voteType": "LIKE"
}

### ----------------------------------------
### 7-2. ì†Œì„¤ ì‹«ì–´ìš” íˆ¬í‘œ
### ----------------------------------------
POST {{baseUrl}}/api/reactions/votes/books
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "bookId": {{createdBookId}},
  "voteType": "DISLIKE"
}

### ----------------------------------------
### 7-3. ë¬¸ì¥ ì¢‹ì•„ìš” íˆ¬í‘œ
### ----------------------------------------
POST {{baseUrl}}/api/reactions/votes/sentences/{{sentenceId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "voteType": "LIKE"
}

### ----------------------------------------
### 7-4. ë¬¸ì¥ ì‹«ì–´ìš” íˆ¬í‘œ
### ----------------------------------------
POST {{baseUrl}}/api/reactions/votes/sentences/{{sentenceId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "voteType": "DISLIKE"
}

### ===================================================================
### 8. ì—ëŸ¬ ì¼€ì´ìŠ¤ ë° ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
### ===================================================================

### ----------------------------------------
### 8-1. ì˜ëª»ëœ ì´ë©”ì¼ í˜•ì‹
### ----------------------------------------
POST {{baseUrl}}/api/auth/signup
Content-Type: application/json

{
  "userEmail": "invalid-email",
  "userPw": "password123!",
  "userNicknm": "í…ŒìŠ¤íŠ¸"
}

### ----------------------------------------
### 8-2. í† í° ì—†ì´ ì¸ì¦ í•„ìš” API ìš”ì²­
### ----------------------------------------
GET {{baseUrl}}/api/members/me
